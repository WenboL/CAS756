rule BuyEat-BeHappy 
  transform sp : BuyEat!people, sf: BuyEat!food, sb: BuyEat!buy, se: BuyEat!eat
  to t : BeHappy!people
  
  if (sp.source==se.source && sp.target==se.target){
  t.name = sp.name;
  t.isHappy = True;
  }


  
  n.name = t.label;
  
  // If t is not the top tree
  // create an edge connecting n
  // with the Node created from t's parent
  if (t.parent.isDefined()) {
    var e : new Graph!Edge;
    e.source ::= t.parent;
    e.target = n;
  }  
}